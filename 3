CREATE TABLE AUTHOR
(AUTHORID INT, 
NAME VARCHAR(20), 
CITY VARCHAR(20), 
COUNTRY VARCHAR(15), PRIMARY KEY(AUTHORID));

CREATE TABLE PUBLISHER
(PUBLISHERID INT, 
NAME VARCHAR(20), 
CITY VARCHAR(20), 
COUNTRY VARCHAR(15), 
PRIMARY KEY(PUBLISHERID));

CREATE TABLE CATEGORY
(CATEGORYID INT,
DESCRIPTION VARCHAR(20),
PRIMARY KEY(CATEGORYID));

CREATE TABLE CATALOG
(BOOKID INT,
TITLE VARCHAR(20),
AUTHORID INT, 
PUBLISHERID INT,
CATEGORYID INT,
YEAR INT,
PRICE INT, 
PRIMARY KEY(BOOKID), 
FOREIGN KEY(AUTHORID) REFERENCES AUTHOR(AUTHORID),
FOREIGN KEY(PUBLISHERID) REFERENCES PUBLISHER(PUBLISHERID),
FOREIGN KEY(CATEGORYID) REFERENCES CATEGORY(CATEGORYID));

CREATE TABLE ORDER_DETAILS
(ORDERNO INT,
BOOKID INT,
QUANTITY INT,
PRIMARY KEY(ORDERNO,BOOKID),
FOREIGN KEY(BOOKID) REFERENCES CATALOG(BOOKID));

 
INSERT INTO AUTHOR VALUES(1,'KIRAN','BNAGALORE','INDIA');
INSERT INTO AUTHOR VALUES(2,'AKASH','BNAGALORE','INDIA');
INSERT INTO AUTHOR VALUES(3,'REVANNA','BNAGALORE','INDIA');
INSERT INTO AUTHOR VALUES(4,'RLK','BNAGALORE','INDIA');
INSERT INTO AUTHOR VALUES(5,'SHAKTHI','BNAGALORE','INDIA');

INSERT INTO PUBLISHER VALUES(01,'Once Upon a Time','BANGALORE','INDIA');
INSERT INTO PUBLISHER VALUES(02,'RAINY WAY','BANGALORE','INDIA');
INSERT INTO PUBLISHER VALUES(03,'ATTITUDE','BANGALORE','INDIA');
INSERT INTO PUBLISHER VALUES(04,'THINK LIKE A MONK','BANGALORE','INDIA');
INSERT INTO PUBLISHER VALUES(05,'FAULT IN STARS','BANGALORE','INDIA');

INSERT INTO CATEGORY VALUES(001,'BREAVE WAORIOR');
INSERT INTO CATEGORY VALUES(002,'STORY');
INSERT INTO CATEGORY VALUES(031,'HORROR');
INSERT INTO CATEGORY VALUES(003,'GOD');
INSERT INTO CATEGORY VALUES(005,'GAMING');

INSERT INTO CATALOG VALUES(11,'BOOK',1,01,001,2000,700);
INSERT INTO CATALOG VALUES(12,'BOOK',1,02,002,2000,800);
INSERT INTO CATALOG VALUES(13,'BOOK',1,03,003,2000,900);
INSERT INTO CATALOG VALUES(14,'BOOK',3,04,031,2000,1000);
INSERT INTO CATALOG VALUES(15,'BOOK',3,05,005,2000,600);
INSERT INTO CATALOG VALUES(16,'SCIENCE',4,05,005,1998,600);

INSERT INTO ORDER_DETAILS VALUES(20,11,100);
INSERT INTO ORDER_DETAILS VALUES(21,15,150);
INSERT INTO ORDER_DETAILS VALUES(22,14,200);
INSERT INTO ORDER_DETAILS VALUES(23,13,90);
INSERT INTO ORDER_DETAILS VALUES(24,12,80);

SELECT * 
FROM AUTHOR 
WHERE AUTHORID IN (SELECT AUTHORID 
FROM CATALOG 
GROUP BY AUTHORID 
HAVING COUNT(*) >2 AND AUTHORID IN(SELECT AUTHORID 
FROM CATALOG 
WHERE (PRICE > 
(SELECT AVG(PRICE) FROM CATALOG)
AND YEAR>=2000)));

SELECT name FROM author a,catalog c 
WHERE a.authorid=c.authorid AND 
bookid IN (SELECT bookid FROM order_details WHERE quantity=
(SELECT MAX(quantity) FROM order_details));

SELECT BOOKID, TITLE, PRICE, PRICE*1.1 
FROM CATALOG;
